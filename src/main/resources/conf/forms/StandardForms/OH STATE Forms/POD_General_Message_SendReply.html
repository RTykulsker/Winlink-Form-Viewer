<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>POD-General Message</title><style type="text/css">
body, td, th {
font-family: Arial,Helvetica,sans-serif;
font-size: 14px;
}
.zentriert {
text-align: center;
}
input, select {
padding: 1px;
-moz-border-radius-topleft: 2px;
-moz-border-radius-topright: 2px;
-moz-border-radius-bottomright: 2px;
-moz-border-radius-bottomleft: 2px;
font-family: Arial,Helvetica,sans-serif;
font-size: 12px;
font-weight: normal;
font-style: normal;
}
textarea {
padding: 1px;
-moz-border-radius-topleft: 2px;
-moz-border-radius-topright: 2px;
-moz-border-radius-bottomright: 2px;
-moz-border-radius-bottomleft: 2px;
font-family: Arial,Helvetica,sans-serif;
font-size: 12px;
font-style: normal;
font-weight: normal;
}
.rechtsbuendig {
text-align: right;
}
.SubmitBtn {
text-align: right;
}
.version {
font-size: 10px;
color: #666666;
position: relative;
left: 0px;
top: 3px;
}
.formtext {font-family: Arial, Helvetica, sans-serif;
font-size: 11pt;
font-weight: normal;
}
.style2 {font-size: 12px}
</style>
<script>
function AutoGrowTextArea(textField)
{
if (textField.clientHeight < textField.scrollHeight)
{
textField.style.height = textField.scrollHeight + "px";
if (textField.clientHeight < textField.scrollHeight)
{
textField.style.height = (textField.scrollHeight * 2 - textField.clientHeight) + "px";
}
}
}
function Countthelines(f) { var text1 = f
var text2 = text1.replace(/\s+$/,"");
var split2 = text2.split("\n"); var mytotal = split2.length * 17;
if (mytotal < 150) {
mytotal = 150;
}
var tstr = mytotal.toString();
return tstr;
}
function newfix(f){
var ThisText = document.getElementById(f).value;
var makeit = Countthelines(ThisText);
document.getElementById(f).style.height = makeit+"px"; }
function Fixarea() {
newfix("msg");
newfix("reply");
AutoGrowTextArea(document.getElementById("msg"));
AutoGrowTextArea(document.getElementById("reply"));
}
function RWS(str){
var text2 = str.replace(/\s+$/,"");
return text2.trim();
}

function shortmonth(monthnum) {
var monthname;
shortmonths = ["JAN", "FEB", "MAR","APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"] ;
monthname = shortmonths [monthnum];s
return monthname; }

function SetDateTime(TType,TheFld, FocusFld) {
var txt;
var myprompt;
var d = new Date(),
thisyear = d.getFullYear();
thismonth= d.getMonth();
thisday = d.getDate();
var submonth = thismonth+1; ;
if (submonth < 10) { submonth = "0"+submonth};
var subday = thisday;
if (thisday < 10) { thisday = "0"+thisday};
var monname;
h = (d.getHours()<10?'0':'') + d.getHours()
m = (d.getMinutes()<10?'0':'') + d.getMinutes()
s = (d.getSeconds()<10?'0':'') + d.getSeconds();
var now = new Date();
var utch = now.getUTCHours();
if (utch < 10) { utch = "0"+utch};
var utcs = now.getUTCMinutes();
if (utcs < 10) { utcs = "0"+utcs};
var myUTCtime = utch+":"+utcs+"Z";
var utcstr = d.toUTCString();
var localt = d.toLocaleTimeString();
var isostr = d.toISOString();
monthname = shortmonth (thismonth);
thismonth = thismonth + 1;
switch (TType) {
case 'hms' :
myprompt = h + ':' + m + ':' + s;
var RightNow = prompt("Time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'hm' :
myprompt = h + ':' + m;
var RightNow = prompt("Time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'm-d-y': myprompt = thismonth+ '-' + thisday+ '-'+ thisyear;
var RightNow = prompt("Date:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'm/d/y': myprompt = thismonth+ '/' + thisday+ '/'+ thisyear;
var RightNow = prompt("Date:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'd mmm y': myprompt = thisday+ ' ' + monthname+ ' '+ thisyear;
var RightNow = prompt("Date:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'mmm-d-y': myprompt = monthname+'-'+thisday+ '-' + thisyear;
var RightNow = prompt("Date:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'localampm': var myprompt = localt;
var RightNow = prompt("Local time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'fulldate': var myprompt = thisyear+ '-'+thismonth+'-'+thisday;
var RightNow = prompt("Date:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'fulldatetime': var myprompt = thisyear+'-'+thismonth+ '-'+thisday+' '+h + ':' + m ;
var RightNow = prompt("Date time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
}//var ORTimestamp = thisyear+submonth+subday+h+m+s;
//document.getElementById('TimeStampOR').value = ORTimestamp; break;

}
// add save load


function saveTextAsFile(fileNameToSaveAs, textToWrite) {
var textToWrite = document.getElementById('parseme').value; 
var fileNameToSaveAs = "POD Reply Message " + DateforFile()+".txt";
fileNameToSaveAs = prompt("", fileNameToSaveAs);

  /* Saves a text string as a blob file*/  
  var ie = navigator.userAgent.match(/MSIE\s([\d.]+)/),
      ie11 = navigator.userAgent.match(/Trident\/7.0/) && navigator.userAgent.match(/rv:11/),
      ieEDGE = navigator.userAgent.match(/Edge/g),
      ieVer=(ie ? ie[1] : (ie11 ? 11 : (ieEDGE ? 12 : -1)));

  if (ie && ieVer<10) {
    console.log("No blobs on IE ver<10");
    return;
  }

  var textFileAsBlob = new Blob([textToWrite], {
    type: 'text/plain'
  });

  if (ieVer>-1) {
    window.navigator.msSaveBlob(textFileAsBlob, fileNameToSaveAs);

  } else {
    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
    downloadLink.onclick = function(e) { document.body.removeChild(e.target); };
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink);
    downloadLink.click();
  }
}





function destroyClickedElement(event)
{
    document.body.removeChild(event.target);
}

function loadFileAsText()
{

    var fileToLoad = document.getElementById("fileToLoad").files[0];
 
    var fileReader = new FileReader();
    fileReader.onload = function(fileLoadedEvent) 
    {
        var textFromFileLoaded = fileLoadedEvent.target.result;
        document.getElementById("inputTextToSave").value = textFromFileLoaded;
    };
    fileReader.readAsText(fileToLoad, "UTF-8");
}


function DateforFile(RightNow) {
var txt;
var d = new Date(),
thisyear = d.getFullYear();
thismonth= d.getMonth();
thismonth = thismonth+1;
if (thismonth < 10) { thismonth = "0" + thismonth}

thisday = d.getDate();
if (thisday < 10) { thisday = "0" + thisday}

h = (d.getHours()<10?'0':'') + d.getHours()
m = (d.getMinutes()<10?'0':'') + d.getMinutes()
var myprompt = thisyear+ '-'+thismonth+'-'+thisday+' '+h + '_' + m ;
return myprompt;
}

function isObject(arg) {
  return Object.prototype.toString.call(arg)==='[object Object]';
}

function formDataToObject(elForm) {
  if (!elForm instanceof Element) return;
  var fields = elForm.querySelectorAll('input, select, textarea'),
    o = {};
  for (var i=0, imax=fields.length; i<imax; ++i) {
    var field = fields[i],
      sKey = field.name || field.id;
    if (field.type==='button' || field.type==='image' || field.type==='submit' || !sKey) continue;
    switch (field.type) {
      case 'checkbox':
        o[sKey] = +field.checked;
        break;
      case 'radio':
        if (o[sKey]===undefined) o[sKey] = '';
        if (field.checked) o[sKey] = field.value;
        break;
      case 'select-multiple':
        var a = [];
        for (var j=0, jmax=field.options.length; j<jmax; ++j) {
          if (field.options[j].selected) a.push(field.options[j].value);
        }
        o[sKey] = a;
        break;
      default:
        o[sKey] = field.value;
    }
  }
 // alert('Form data:\n\n' + JSON.stringify(o, null, 2));
 document.getElementById('parseme').value = JSON.stringify(o, null, 2);
//  return o;
}

function populateForm(o) {

o =  JSON.parse(document.getElementById('parseme').value);
 //if (!isObject(o)) return;
if (!isObject(o)) return;
  for (var i in o) {
    var el = document.getElementById(i) || document.querySelector('[name=' + i + ']');
    if (el.type==='radio') el = document.querySelectorAll('[name=' + i + ']');
    switch (typeof o[i]) {
      case 'number':
        el.checked = o[i];
        break;
      case 'object':
        if (el.options && o[i] instanceof Array) {
          for (var j=0, jmax=el.options.length; j<jmax; ++j) {
            if (o[i].indexOf(el.options[j].value)>-1) el.options[j].selected = true;
          }
        }
        break;
      default:
        if (el instanceof NodeList) {
          for (var j=0, jmax=el.length; j<jmax; ++j) {
            if (el[j].value===o[i]) el[j].checked = true;
          }
        } else {
          el.value = o[i];
        }
    }
  }
    Fixfields();


}

function SaveData() {
	
			formDataToObject(document.getElementById('myform'))
			saveTextAsFile();
			
			//saveTextAsFile();
			}

//-------
 function readBlob(opt_startByte, opt_stopByte) {
  
    var files = document.getElementById('files').files;
    if (!files.length) {
      alert('Please select a file!');
      return;
    }

    var file = files[0];
    var start = parseInt(opt_startByte) || 0;
    var stop = parseInt(opt_stopByte) || file.size - 1;

    var reader = new FileReader();

    // If we use onloadend, we need to check the readyState.
    reader.onloadend = function(evt) {
      if (evt.target.readyState == FileReader.DONE) { // DONE == 2
        document.getElementById('byte_content').textContent = evt.target.result;
        document.getElementById('byte_range').textContent = 
            ['Read bytes: ', start + 1, ' - ', stop + 1,
             ' of ', file.size, ' byte file'].join('');
      }
    };

    var blob = file.slice(start, stop + 1);
    reader.readAsBinaryString(blob);
  }
    	
  window.onload = function () { 
 
 //Check the support for the File API support 
 if (window.File && window.FileReader && window.FileList && window.Blob) {
    var fileSelected = document.getElementById('txtfiletoread');
	
    fileSelected.addEventListener('change', function (e) { 
         //Set the extension for the file 
         var fileExtension = /text.*/; 
         //Get the file object 
         var fileTobeRead = fileSelected.files[0];
        //Check of the extension match 
         if (fileTobeRead.type.match(fileExtension)) { 
             //Initialize the FileReader object to read the 2file 
			
             var fileReader = new FileReader(); 
             fileReader.onload = function (e) { 
                 var fileContents = document.getElementById('filecontents'); 
                
				document.getElementById('parseme').value =fileReader.result;
				populateForm(obj = document.getElementById('parseme').value);
					 } 
             fileReader.readAsText(fileTobeRead); 
         } 
         else { 
             alert("Please select text file"); 
         }
 
    }, false);
} 
 else { 
     alert("Files are not supported"); 
 } 
 Fixfields();
 }
 
 function Fixfields() { 
 AutoGrowTextArea(document.getElementById("Reply"));


}
// function setcolors() {



</script></head>
<body>
<form  style="font-family: Arial;"onsubmit="return confirm('To complete your form submission, click OK and close the open browser window. You will return to the new message window so you can post your message to the outbox');" method="post" id="myform" enctype="multipart/form-data" action="http://{FormServer}:{FormPort}">
<table align="center" border="0" width="900">
<tbody>
<tr>
<td pbzloc="24">
<table pbzloc="26" style="width: 932px; height: 597px;" border="2" bordercolor="#999999" cellpadding="2" cellspacing="0">
<tbody>
<tr>
<td colspan="2" valign="top" style="height: 35px; text-align: center; vertical-align: middle; background-color: rgb(204, 255, 255);"><p><small><big><big>POINT OF
  DISPENSE</big> <big>GENERAL
  MESSAGE FORM</big></big></small><strong><small><big>&nbsp;
  </big><big style="font-weight: normal;"><big>(Medical)</big></big><big style="font-weight: bold;"><big> &nbsp;<small>&nbsp;</small></big></big></small></strong><span class="style2"><small><small><big pbzloc="1">
  Vers 7 </big></small></small></span></p>
<input type="button" value=" Load Reply POD Message" onclick="document.getElementById('txtfiletoread').click();" />
  <input type="file" id="txtfiletoread" accept=".txt"  style="display: none;"/>
</td>
</tr>
<tr>
<td style="text-align: center;" colspan="4"><div align="left"><strong style="font-weight: normal;"><br />
  </strong><strong><span style="font-weight: normal;">&nbsp; </span></strong><strong style="font-weight: normal;">1. Incident Name</strong><strong style="font-weight: normal;"></strong>
  <input id="Incident_Name" maxlength="60" name="Incident_Name" readonly="readonly" size="70" value="{var Incident_Name}" type="text" />
</div></td>
</tr>
<tr>
<td style="text-align: center;" colspan="2"><div align="left"><strong><span style="font-weight: normal;"><br />
&nbsp; 2. To </span></strong><span style="font-weight: normal;">(Name
  / Position)</span><strong style="font-weight: normal;"></strong><span style="font-weight: bold;"> </span>
  <input readonly="readonly" value="{var To_Name}" style="" id="To_Name" maxlength="60" name="To_Name" size="70" />
</div></td>
</tr>
<tr>
<td style="text-align: center;" colspan="2"><div align="left"><strong><span style="font-weight: normal;"><br />
&nbsp; 3. From</span> </strong><span style="font-weight: normal;">(Name / Position)</span><strong style="font-weight: normal;"></strong><span style="font-weight: normal;"> </span>
  <input id="From_Name" maxlength="60" name="From_Name" readonly="readonly" size="70" value="{var From_Name}" type="text" />
</div><textarea name="parseme" cols="60" id="parseme" style="display: none;"></textarea></td>
</tr>
<tr>
<td style="text-align: center;" colspan="2"><div align="left"><span style="font-weight: normal;"><br />
      <strong><span style="font-weight: normal;">&nbsp; </span></strong>4. Subject</span>      <input id="Subjectline" maxlength="50" name="Subjectline" pbzloc="23" readonly="readonly" size="55" value="{var Subjectline}" /> 
      <span style="font-weight: normal;">&nbsp;5.
  Date</span><strong>
  <input id="Date" maxlength="14" name="Date" readonly="readonly" size="14" value="{var Date}" type="text" />
  <span style="font-weight: normal;">&nbsp;</span></strong><span style="font-weight: normal;"> 6.Time </span><strong>
  <input id="Time" maxlength="12" name="Time" readonly="readonly" size="12" value="{var Time}" type="text" /> 
</strong></div></td>
</tr>
<tr>
<td colspan="2" style="text-align: center; "><div align="left"><span style="font-weight: normal;"><br />
      <strong><span style="font-weight: normal;">&nbsp; </span></strong>7. Message Priority</span>
      <strong pbzloc="17">
      <input id="Priority" maxlength="12" name="Priority" readonly="readonly" size="12" value="{var Priority}" />
      </strong> <span style="font-weight: normal;">&nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp;&nbsp; 7A. This concerns a Vaccine&nbsp;</span>
      <strong pbzloc="21">
      <input id="Response" maxlength="12" name="Response" readonly="readonly" size="12" value="{var Vaccine}" />
    &nbsp;&nbsp;</strong></div></td>
</tr>
<tr>
<td colspan="2">
<table  style="width: 810px; height: 86px;" border="2" bordercolor="#FFFFFF" cellpadding="2" cellspacing="0">
<tbody>
<tr>
<td style="text-align: center;" colspan="2">
<table border="1" cellpadding="2" cellspacing="0" style="text-align: left; width: 908px; height: 115px;">
<tbody>
<tr bgcolor="#FFFFCC">
<td style="width: 50%; text-align: center; font-weight: normal;">Vaccine
Name</td>
<td bgcolor="#FFFFCC" style="text-align: center; font-weight: normal;">Doses
Remaining</td>
<td style="text-align: center; font-weight: normal;">Time</td>
</tr>
<tr>
<td style="text-align: center;"><input maxlength="50" name="Vaccine1" readonly="readonly" size="60" value="{var Vaccine1}" type="text" /></td>
<td style="text-align: center;"><input maxlength="8" name="Doses1" readonly="readonly" size="8" value="{var Doses1}" type="text" /></td>
<td style="text-align: center;"><input maxlength="10" name="Time1" readonly="readonly" size="10" value="{var Time1}" type="text" /></td>
</tr>
<tr>
<td style="text-align: center;"><input maxlength="50" name="Vaccine2" readonly="readonly" size="60" value="{var Vaccine2}" type="text" /></td>
<td style="text-align: center;"><input maxlength="8" name="Doses2" readonly="readonly" size="8" value="{var Doses2}" type="text" /></td>
<td style="text-align: center;"><input maxlength="10" name="Time2" readonly="readonly" size="10" value="{var Time2}" type="text" /></td>
</tr>
<tr>
<td style="text-align: center;"><input maxlength="50" name="Vaccine3" readonly="readonly" size="60" value="{var Vaccine3}" type="text" /></td>
<td style="text-align: center;"><input maxlength="8" name="Doses3" readonly="readonly" size="8" value="{var Doses3}" type="text" /></td>
<td style="text-align: center;"><input maxlength="10" name="Time3" readonly="readonly" size="10" value="{var Time3}" type="text" /></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr style="font-weight: normal;">
<td height="70" colspan="4" bgcolor="#FFFFE6" style="vertical-align: top;  text-align: justify; "><div align="left"><strong><span style="font-weight: normal;">&nbsp; </span></strong><strong style="font-weight: normal;"></strong>8. Original
  Message 
    <input name="Message" type="hidden" id="Message" value="{var Message}" />
    <br /><br />
  <strong><span style="font-weight: normal;">&nbsp; </span></strong>
  <label pbzloc="25"><span style="width:750px; word-wrap:break-word; margin: 10px;  display:inline-block;">{var Message}</span></label>
</div>
  </td>
</tr>
<tr>
<td height="35" colspan="4" style="text-align: center;"><div align="left"><span style="font-weight: normal;"><strong><span style="font-weight: normal;">&nbsp; </span></strong><strong style="font-weight: normal;"></strong>9. Approved By &nbsp;</span>
      <input id="Approved_Name" maxlength="30" name="Approved_Name" readonly="readonly" size="35" value="{var Approved_Name}" type="text" />
      <span style="font-weight: normal;"> </span>&nbsp;
&nbsp; &nbsp;&nbsp;
  <span style="font-weight: normal;">Position</span>
&nbsp;<small> </small>
  <input id="Approved_PosTitle" maxlength="30" name="Approved_PosTitle" readonly="readonly" size="35" value="{var Approved_PosTitle}" type="text" />
</div></td>
</tr>
<tr>
<td style="text-align: center;" colspan="4"><div align="left">
  <p><strong><span style="font-weight: normal;">&nbsp;</span></strong><strong style="font-weight: normal;">10. Reply <small>(Be brief and
      accurate)</small></strong><br />
    </p>
  </div>
  <div align="left">
    <label>
    <strong><span style="font-weight: normal;">&nbsp; </span></strong>
    <textarea cols="130" id="Reply" name="Reply" rows="4"onchange="this.value=RWS(this.value)" onkeyup="AutoGrowTextArea(this)"></textarea> 
    </label>
  </div></td>
</tr>
<tr>
<td style="text-align: center;" colspan="4"><div align="left"><span style="font-weight: normal;"><br />
      <strong><span style="font-weight: normal;">&nbsp; </span></strong><strong style="font-weight: normal;"></strong>11. Replied By</span>&nbsp;
  <input id="Replied_Name" maxlength="30" name="Replied_Name" required="required" size="35" type="text" /> 
&nbsp; <small style="font-weight: normal;"><big>Date &amp; Time</big></small><span style="font-weight: normal;">&nbsp;</span><strong>
  <input title="You can overwrite if needed" value="{DateTime}" id="DateTime"  onclick="SetDateTime('fulldatetime',this.id)" maxlength="22" name="DateTime" required="required" size="22" />
&nbsp;</strong>&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp;<span style="font-weight: normal;"></span></div></td>
</tr>
<tr>
<td style="text-align: center;" colspan="2">
  <div align="left"><span style="font-weight: normal;">&nbsp;
&nbsp; &nbsp;<br />
&nbsp;&nbsp; &nbsp; <strong><span style="font-weight: normal;">&nbsp; </span></strong><strong style="font-weight: normal;"></strong>&nbsp;Position&nbsp;</span>
      <input id="Replied_PosTitle" maxlength="30" name="Replied_PosTitle" required="required" size="35" type="text" /> 
    &nbsp; <span style="font-weight: normal;">Facility &nbsp;</span>
      <input id="Facility" maxlength="45" name="Facility" required="required" size="50" />
  </div></td>
</tr>
<tr>
  <td colspan="2"><span style="font-family: Calibri;"><small><span class="formtext"><span style="font-family: Calibri;"><small><big><big><small><span style="font-family: Calibri;">
    <input type="button" value="Save Reply POD Message"  style="color: blue;"onclick="SaveData()" />
    </span>&nbsp;&nbsp;</small></big></big></small></span></span></small></span>
    <input class="SubmitBtn" enctype="multipart/form-data" id="Submit" name="Submit" post="" style="color: green;" value="Submit" type="submit" /> <input class="BtnFormat2" value="Reset Form " name="ResetForm" style="color: rgb(204, 0, 0);" type="reset" />&nbsp;<small><big> &nbsp; &nbsp; &nbsp;
&nbsp;
&nbsp;</td></tr>
</tbody>
</table>
<br />
&nbsp;</td>
</tr>
</tbody>
</table>
</form>
</body></html>