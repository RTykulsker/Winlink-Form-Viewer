<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>AK State ARES ICS213</title>

<style type="text/css">
body, td, th {
font-family: Arial,Helvetica,sans-serif;
font-size: 12px;
font-weight: inherit;
}
.zentriert {
font-size: 12px;
}
input, select {
padding: 1px;
-moz-border-radius-topleft: 2px;
-moz-border-radius-topright: 2px;
-moz-border-radius-bottomright: 2px;
-moz-border-radius-bottomleft: 2px;
font-family: Arial,Helvetica,sans-serif;
font-size: 12px;
font-weight: inherit;
}
textarea {
padding: 1px;
-moz-border-radius-topleft: 2px;
-moz-border-radius-topright: 2px;
-moz-border-radius-bottomright: 2px;
-moz-border-radius-bottomleft: 2px;
font-family: Arial,Helvetica,sans-serif;
font-size: 12px;
font-weight: inherit;
}
.rechtsbuendig {
font-size: 12px;
}
.SubmitBtn {
font-size: 12px;
}
.version {
color: #666666;
position: relative;
left: 0px;
top: 3px;
font-size: 12px;
}
h1, h2, h3, h4, h5, h6 {
font-style: normal;
font-weight: normal;
}
.FormReg {font-size: 11px; font-family:Arial, Helvetica, sans-serif}
.formbold {font-size: 11px; font-weight: bold; font-family:Arial, Helvetica, sans-serif}
.style1 {font-size: 16px}
.style2 {
	color: #2A5F00;
	font-size: 14px;
}
  input[type=button] {

  border: 2px solid #0f88f2;;
   border-radius:.25rem;
  color: black;
  padding: 2px 2px;
 background-color: white;
  text-decoration: none;
  margin: 2px 2px;
  cursor: pointer;
}
input[type=submit] {
 border: 2px solid green;
  border-radius:.25rem;
  background-color: white;
  color: black;
  padding: 2px 2px;
  font-size: 14px;
   cursor: pointer;
}
input[type=reset] {
 border: 2px solid red;
 border-radius:.25rem;
  background-color: white;
  color: black;
  padding: 2px 2px;
  font-size: 14px;
   cursor: pointer;
}
input[type=black1] {
 border: 2px solid #999999;
   width:225px;
  border-radius:.25rem;

  background-color: white;
  color: black;
  padding: 2px 2px;
  font-size: 14px;
   cursor: pointer;
}

</style><!-- ICS 213 Template-->

<script>
function wordcount(s) {
s = s.replace(/(^\s*)|(\s*$)/gi,"");//exclude start and end white-space
s = s.replace(/\n/g, " "); // Convert CR to spacing
s = s.replace(/[ ]{2,}/gi," ");//2 or more space to 1
cnt = s.split(' ').length; var ele = document.getElementById('check');
 document.getElementById('Check').value= cnt;
}

function CheckText() {
var MSGText = document.getElementById('Message').value;

wordcount(document.getElementById('Message').value)

}

function AutoGrowTextArea(textField)
{
if (textField.clientHeight < textField.scrollHeight)
{
textField.style.height = textField.scrollHeight + "px";
if (textField.clientHeight < textField.scrollHeight)
{
textField.style.height = (textField.scrollHeight * 2 - textField.clientHeight) + "px";
}
}
}
function Countthelines(f) { var text1 = f
var text2 = text1.replace(/\s+$/,"");
var split2 = text2.split("\n"); var mytotal = split2.length * 17;
if (mytotal < 150) {
mytotal = 150;
}
var tstr = mytotal.toString();
return tstr;
}
function newfix(f){
var ThisText = document.getElementById(f).value;
var makeit = Countthelines(ThisText);
document.getElementById(f).style.height = makeit+"px"; }
function Fixarea() {
newfix("Message");
// newfix("reply");
AutoGrowTextArea(document.getElementById("Message"));
// AutoGrowTextArea(document.getElementById("reply"));
}
function RWS(str){
var text2 = str.replace(/\s+$/,"");
return text2.trim();
}

</script>
<script>

function shortmonth(monthnum) {
var monthname;
shortmonths = ["JAN", "FEB", "MAR","APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"] ;
monthname = shortmonths [monthnum];s
return monthname; }
function SetDateTime(TType,TheFld, FocusFld) {
var txt;
var myprompt;
var d = new Date(),
thisyear = d.getFullYear();
thismonth= d.getMonth();
thisday = d.getDate();
var monname;
h = (d.getHours()<10?'0':'') + d.getHours()
m = (d.getMinutes()<10?'0':'') + d.getMinutes()
s = (d.getSeconds()<10?'0':'') + d.getSeconds();
var now = new Date();
var utch = now.getUTCHours();
if (utch < 10) { utch = "0"+utch};
var utcs = now.getUTCMinutes();
if (utcs < 10) { utcs = "0"+utcs};
var myUTCtime = utch+":"+utcs+"Z";
var utcstr = d.toUTCString();
var localt = d.toLocaleTimeString();
var isostr = d.toISOString();
monthname = shortmonth (thismonth);
thismonth = thismonth + 1;
switch (TType) {
case 'hms' :
myprompt = h + ':' + m + ':' + s;
var RightNow = prompt("Time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'hm' :
myprompt = h + ':' + m;
var RightNow = prompt("Time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'm-d-y': myprompt = thismonth+ '-' + thisday+ '-'+ thisyear;
var RightNow = prompt("Date:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'm/d/y': myprompt = thismonth+ '/' + thisday+ '/'+ thisyear;
var RightNow = prompt("Date:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'd mmm y': myprompt = thisday+ ' ' + monthname+ ' '+ thisyear;
var RightNow = prompt("Date:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'mmm-d-y': myprompt = monthname+'-'+thisday+ '-' + thisyear;
var RightNow = prompt("Date:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'localampm': var myprompt = localt;
var RightNow = prompt("Local time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'fulldate': var myprompt = thisyear+ '-'+thismonth+'-'+thisday;
var RightNow = prompt("Date:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'fulldatetime': var myprompt = thisyear+'-'+thismonth+ '-'+thisday+' '+h + ':' + m ;
var RightNow = prompt("Date time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'afulldatetime': var myprompt = thisyear+'-'+thismonth+ '-'+thisday+' '+h + ':' + m ;
var RightNow = myprompt;
document.getElementById(TheFld).value = RightNow;
break;
case 'autodate': var RightNow = thisyear+'-'+thismonth+ '-'+thisday ;
//var RightNow = prompt("Date time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'autotime': var RightNow = h + ':' + m ;
//var RightNow = prompt("Date time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'iso': var myprompt = isostr;
var RightNow = prompt("Date time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'utc': var myprompt = utcstr;
var RightNow = prompt("Date time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'zulu': var myprompt = isostr;
myprompt = isostr.replace("T", " "); slen = myprompt.length;
myprompt = myprompt.substr(0, slen-5)+'Z';
var RightNow = prompt("Date time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
case 'UTChm': var myprompt = myUTCtime;
var RightNow = prompt("Date time:", myprompt);
document.getElementById(TheFld).value = RightNow;
break;
}
// if(FocusFld !== null && FocusFld !== '') {document.getElementById(FocusFld).focus()} --/
}; 

  /* Saves a text string as a blob file*/  
function saveTextAsFile(fileNameToSaveAs, textToWrite) {
var textToWrite = document.getElementById('parseme').value; 
var fileNameToSaveAs = "AK ICS213 data " + DateforFile()+".txt";
fileNameToSaveAs = prompt("", fileNameToSaveAs);


  var ie = navigator.userAgent.match(/MSIE\s([\d.]+)/),
      ie11 = navigator.userAgent.match(/Trident\/7.0/) && navigator.userAgent.match(/rv:11/),
      ieEDGE = navigator.userAgent.match(/Edge/g),
      ieVer=(ie ? ie[1] : (ie11 ? 11 : (ieEDGE ? 12 : -1)));

  if (ie && ieVer<10) {
    console.log("No blobs on IE ver<10");
    return;
  }

  var textFileAsBlob = new Blob([textToWrite], {
    type: 'text/plain'
  });

  if (ieVer>-1) {
    window.navigator.msSaveBlob(textFileAsBlob, fileNameToSaveAs);

  } else {
    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
    downloadLink.onclick = function(e) { document.body.removeChild(e.target); };
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink);
    downloadLink.click();
  }
}





function destroyClickedElement(event)
{
    document.body.removeChild(event.target);
}

function loadFileAsText()
{

    var fileToLoad = document.getElementById("fileToLoad").files[0];
 
    var fileReader = new FileReader();
    fileReader.onload = function(fileLoadedEvent) 
    {
        var textFromFileLoaded = fileLoadedEvent.target.result;
        document.getElementById("inputTextToSave").value = textFromFileLoaded;
    };
    fileReader.readAsText(fileToLoad, "UTF-8");
}


function DateforFile(RightNow) {
var txt;
var d = new Date(),
thisyear = d.getFullYear();
thismonth= d.getMonth();
thismonth = thismonth+1;
if (thismonth < 10) { thismonth = "0" + thismonth}

thisday = d.getDate();
if (thisday < 10) { thisday = "0" + thisday}

h = (d.getHours()<10?'0':'') + d.getHours()
m = (d.getMinutes()<10?'0':'') + d.getMinutes()
var myprompt = thisyear+ '-'+thismonth+'-'+thisday+' '+h + '_' + m ;
return myprompt;
}

function isObject(arg) {
  return Object.prototype.toString.call(arg)==='[object Object]';
}

function formDataToObject(elForm) {
  if (!elForm instanceof Element) return;
  var fields = elForm.querySelectorAll('input, select, textarea'),
    o = {};
  for (var i=0, imax=fields.length; i<imax; ++i) {
    var field = fields[i],
      sKey = field.name || field.id;
    if (field.type==='button' || field.type==='image' || field.type==='submit' || !sKey) continue;
    switch (field.type) {
      case 'checkbox':
        o[sKey] = +field.checked;
        break;
      case 'radio':
        if (o[sKey]===undefined) o[sKey] = '';
        if (field.checked) o[sKey] = field.value;
        break;
      case 'select-multiple':
        var a = [];
        for (var j=0, jmax=field.options.length; j<jmax; ++j) {
          if (field.options[j].selected) a.push(field.options[j].value);
        }
        o[sKey] = a;
        break;
      default:
        o[sKey] = field.value;
    }
  }
 // alert('Form data:\n\n' + JSON.stringify(o, null, 2));
 document.getElementById('parseme').value = JSON.stringify(o, null, 2);
//  return o;
}

function populateForm(o) {

o =  JSON.parse(document.getElementById('parseme').value);
 //if (!isObject(o)) return;
if (!isObject(o)) return;
  for (var i in o) {
    var el = document.getElementById(i) || document.querySelector('[name=' + i + ']');
    if (el.type==='radio') el = document.querySelectorAll('[name=' + i + ']');
    switch (typeof o[i]) {
      case 'number':
        el.checked = o[i];
        break;
      case 'object':
        if (el.options && o[i] instanceof Array) {
          for (var j=0, jmax=el.options.length; j<jmax; ++j) {
            if (o[i].indexOf(el.options[j].value)>-1) el.options[j].selected = true;
          }
        }
        break;
      default:
        if (el instanceof NodeList) {
          for (var j=0, jmax=el.length; j<jmax; ++j) {
            if (el[j].value===o[i]) el[j].checked = true;
          }
        } else {
          el.value = o[i];
        }
    }
  }
    Fixfields();
 RestoreTitle();


}

function SaveData() {
	
			formDataToObject(document.getElementById('myform'))
			saveTextAsFile();
			
			//saveTextAsFile();
			}

//-------
 function readBlob(opt_startByte, opt_stopByte) {
  
    var files = document.getElementById('files').files;
    if (!files.length) {
      alert('Please select a file!');
      return;
    }

    var file = files[0];
    var start = parseInt(opt_startByte) || 0;
    var stop = parseInt(opt_stopByte) || file.size - 1;

    var reader = new FileReader();

    // If we use onloadend, we need to check the readyState.
    reader.onloadend = function(evt) {
      if (evt.target.readyState == FileReader.DONE) { // DONE == 2
        document.getElementById('byte_content').textContent = evt.target.result;
        document.getElementById('byte_range').textContent = 
            ['Read bytes: ', start + 1, ' - ', stop + 1,
             ' of ', file.size, ' byte file'].join('');
      }
    };

    var blob = file.slice(start, stop + 1);
    reader.readAsBinaryString(blob);
  }
    	
  window.onload = function () { 
 
 //Check the support for the File API support 
 if (window.File && window.FileReader && window.FileList && window.Blob) {
    var fileSelected = document.getElementById('txtfiletoread');
	
    fileSelected.addEventListener('change', function (e) { 
         //Set the extension for the file 
         var fileExtension = /text.*/; 
         //Get the file object 
         var fileTobeRead = fileSelected.files[0];
        //Check of the extension match 
         if (fileTobeRead.type.match(fileExtension)) { 
             //Initialize the FileReader object to read the 2file 
			
             var fileReader = new FileReader(); 
             fileReader.onload = function (e) { 
                 var fileContents = document.getElementById('filecontents'); 
                
				document.getElementById('parseme').value =fileReader.result;
				populateForm(obj = document.getElementById('parseme').value);
					 } 
             fileReader.readAsText(fileTobeRead); 
         } 
         else { 
             alert("Please select text file"); 
         }
 
    }, false);
} 
 else { 
     alert("Files are not supported"); 
 } 

Fixfields();
Checkifinbrowser();
 }
 
  function Fixfields() {
AutoGrowTextArea(document.getElementById("Message"));

//  AutoGrowTextArea(document.getElementById("Comm3"));
}

function Checkifinbrowser() {
 var x= document.getElementById("testCall").value; 
 var n = x.search("{Msg");
 if (n>-1) { 
 document.getElementById('Submit').style.visibility='hidden';
  alert('You are running this form outside of Winlink.\n \nWhen you have completed the form, SAVE the data and then give or send the SAVED data file to the radio operator. The operator will load the SAVED data into the correct form and send via winlink. ');
 } else {document.getElementById('Submit').style.visibility='visible';  }
}



//load="SetDateTime('autodate','Date');SetDateTime('autotime','Time'); SetDateTime('afulldatetime','DateTime')">

</script></head>
<body >
<form  style="font-family: Arial;" pbzloc="3" onsubmit="return confirm('To complete your form submission, click OK and close the open browser window. You will return to the new message window so you can post your message to the outbox');" method="post" id="myform" enctype="multipart/form-data" action="http://{FormServer}:{FormPort}">
<table pbzloc="59" style="width: 1143px; height: 522px;" align="center" border="0">
<tbody>
<tr>
<td pbzloc="5">
<table style="width: 874px; height: 318px;" border="2" bordercolor="#999999" cellpadding="4" cellspacing="0">
<tbody>
<tr>
<td style="height: 35px;">
<table style="text-align: left; width: 860px; height: 50px;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="vertical-align: top; text-align: center;">No
&nbsp;<br />
<input title="User Option. Overwrite if desired." placeholder="User option" maxlength="14" size="15" name="SeqNum" /></td>
<td style="vertical-align: top; text-align: center;">Precedence<br />
<select id="Priority" name="Priority" pbzloc="4"><option selected="selected" value="Routine">Routine</option><option value="Welfare">Welfare</option><option value="Priority">Priority</option><option value="Emergency">Emergency</option></select>
</td>
<td style="vertical-align: top; text-align: center;">&nbsp;HX<br />
&nbsp;&nbsp; &nbsp;<input maxlength="4" size="4" name="HX" onchange="this.value=this.value.toUpperCase();" />&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: center;">Org Station<br />
<input maxlength="10" size="10" name="OrgStation" onchange="this.value=this.value.toUpperCase();" /></td>
<td style="text-align: center; vertical-align: top;">Check<br />
<input title="Your word count" maxlength="4" size="4" name="Check" id="Check" /></td>
<td style="vertical-align: top; text-align: center;">Org Location<br />
<input maxlength="22" size="22" name="OrgLocation" /></td>
<td style="vertical-align: top; text-align: center;">Time<br />
<input placeholder="Click for Time"  maxlength="8" size="8" name="Time" id="Time" onclick="SetDateTime('hm',this.id)" /> </td>
<td style="vertical-align: top; text-align: center;">Date &nbsp;<br />
<input placeholder="Click for Date" maxlength="11" size="12" name="Date" id="Date" onclick="SetDateTime('fulldate',this.id)" /></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td colspan="2" style="text-align: center; vertical-align: top; background-color: rgb(255, 255, 204);"><strong><small><big><small><big><span style="font-weight: normal;"><span style="font-style: italic;">ALASKA State ARES</span></span></big></small></big></small></strong><strong><small><span style="font-style: italic;">&nbsp;
&nbsp;</span><big style="font-weight: bold;"><big><span style="font-weight: normal;">GENERAL
MESSAGE</span></big></big><small><span style="font-weight: normal;">
</span><big><span style="font-weight: normal;"><small>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="style1"><span class="SubmitBtn">Vers 10 </span><br />
</span><br />  
<input name="loadbtn" type="button" id="loadbtn" onclick="document.getElementById('txtfiletoread').click();" value=" Load AK IC213 data " />
<br />
<textarea name="parseme" cols="60" id="parseme" style="display: none;"></textarea> <span class="formbold"><span class="FormReg"><small>
</small></span></span>
<input type="file" id="txtfiletoread" accept=".txt"  style="display: none;"/>

</small></span></big></small></small></strong></td>
</tr>
<tr>
<td style="text-align: center;" colspan="4"><div align="left"><strong style="font-weight: normal;"><br />
        1.&nbsp;Incident Name</strong><strong style="font-weight: normal;">:</strong>        <input id="Incident_Name" maxlength="60" name="Incident_Name" required="required" size="70" type="text" />
</div></td>
</tr>
<tr>
<td style="text-align: center;" colspan="2"><div align="left"><br />
  2. To (Name/Position):<big>
  </big>  <input id="To_Name" maxlength="60" name="To_Name" required="required" size="70" type="text" />
</div></td>
</tr>
<tr>
<td style="text-align: center;" colspan="2"><div align="left"><strong><span style="font-weight: normal;"><br />
  3. From</span> </strong>(Name/Position):<big> </big>
  <input id="From_Name" maxlength="60" name="From_Name" required="required" size="70" type="text" />
</div></td>
</tr>
<tr>
<td style="text-align: center;" colspan="3"><div align="left"><br />
      4. Subject:&nbsp;      <input id="Subjectline" maxlength="50" name="Subjectline" required="required" size="55" value="{MsgSubject}" type="text" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.
&amp; 6. Date/Time: &nbsp;
  <input value="" size="21" required="required" placeholder="Click for Date/Time"name="DateTime" maxlength="21" id="DateTime" onclick="SetDateTime('fulldatetime',this.id)" title="Defaults to local date/time, you can overwrite it" />
</div></td>
</tr>
<tr>
<td colspan="4" style="height: 88px; vertical-align: top; text-align: center;"><div align="left"><br />
      7.
  Message:&nbsp;<textarea name="parseme" cols="60" id="parseme" style="display: none;"></textarea><br />
</div>
  <div align="left">
    <label>
    <textarea cols="120" id="Message" name="Message" rows="4" onkeyup="CheckText(this.value);AutoGrowTextArea(this)" onchange="this.value=RWS(this.value)"></textarea>
    </label>
  </div></td>
</tr>
<tr>
<td style="text-align: center;" colspan="4"><div align="left"><br />
  8. Approved By: 
      <input id="Approved_Name" maxlength="30" name="Approved_Name" required="required" size="35" />
&nbsp; <small><big>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Position/Title:
</big></small>
  <input id="Approved_PosTitle" maxlength="30" name="Approved_PosTitle" required="required" size="35" type="text" />
</div></td>
</tr>
<tr>
<td colspan="4"><span class="FormReg"><span class="formbold"><small><span style="font-family: Calibri;">
  <input name="savebtn" type="button" id="savebtn"  onclick="SaveData()" value="Save AK ICS213 data" />
</span></small></span></span>&nbsp;
  <input class="SubmitBtn" enctype="multipart/form-data" id="Submit" method="Post" name="Submit" pbzloc="4" size="8" style="height: 24px; width: 48px; " value="Submit" type="submit" />
&nbsp;  <input class="BtnFormat2" value="Reset Form " name="ResetForm" type="reset" /> 
<span class="FormReg">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="formbold"> <small><span style="font-family: Calibri;">
</span></small></span></span><span class="version">
&nbsp; &nbsp; &nbsp; &nbsp;  &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;
&nbsp;&nbsp;
&nbsp;Contact &nbsp;AG6SV for form information</span><strong><small><small><span style="font-weight: normal;">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;
<input name="testCall" type="hidden" id="testCall" value="{MsgSender}" size="14" maxlength="13" />
<input name="Templateversion" type="hidden"

                                    id="Templateversion" value=" Alaska ICS213 v 10.0" /> 
&nbsp;&nbsp;&nbsp; &nbsp;</span></small></small></strong></td>
</tr>
</tbody>
</table>
<br />
&nbsp;</td>
</tr>
</tbody>
</table>
</form>
</body></html>