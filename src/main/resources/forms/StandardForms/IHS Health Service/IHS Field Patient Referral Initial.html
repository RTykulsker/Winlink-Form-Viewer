<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    
    <title>IHS Patient Form</title><style type="text/css">
body, td, th {
  font-family: Arial,Helvetica,sans-serif;
  font-weight: inherit;
  font-size: 10px;
}
.zentriert {
  font-weight: inherit;
  font-size: 12px;
}
input, select {
  padding: 1px;
  -moz-border-radius-topleft: 2px;
  -moz-border-radius-topright: 2px;
  -moz-border-radius-bottomright: 2px;
  -moz-border-radius-bottomleft: 2px;
  font-family: Arial,Helvetica,sans-serif;
  font-weight: inherit;
  font-size: 12px;
}
textarea {
  padding: 1px;
  -moz-border-radius-topleft: 2px;
  -moz-border-radius-topright: 2px;
  -moz-border-radius-bottomright: 2px;
  -moz-border-radius-bottomleft: 2px;
  font-family: Arial,Helvetica,sans-serif;
  font-size: 12px;
  font-weight: inherit;
}
.rechtsbuendig {
  font-weight: inherit;
  font-size: 10px;
}
.SubmitBtn {
  font-weight: inherit;
  font-size: 10px;
}
.version {
  color: #666666;
  position: relative;
  left: 0px;
  top: 3px;
  font-weight: inherit;
  font-size: 10px;
}

.style3 {font-size: 16px}
    .style4 {font-size: 12px}
    .style1 {font-size: 12px}
    .formtext {font-family: Arial, Helvetica, sans-serif;
font-size: 11pt;
font-weight: normal;
}
    </style></head>
<script>
var g1;
var g2;
function AutoGrowTextArea(textField)
{
if (textField.clientHeight < textField.scrollHeight)
{
textField.style.height = textField.scrollHeight + "px";
if (textField.clientHeight < textField.scrollHeight)
{
textField.style.height = (textField.scrollHeight * 2 - textField.clientHeight) + "px";
}
}
}
function Countthelines(f) { var text1 = f
var text2 = text1.replace(/\s+$/,"");
var split2 = text2.split("\n"); var mytotal = split2.length * 17;
if (mytotal < 150) {
mytotal = 150;
}
var tstr = mytotal.toString();
return tstr;
}
function newfix(f){
var ThisText = document.getElementById(f).value;
var makeit = Countthelines(ThisText);
document.getElementById(f).style.height = makeit+"px"; }
function Fixarea() {
newfix("msg");
newfix("reply");
AutoGrowTextArea(document.getElementById("msg"));
AutoGrowTextArea(document.getElementById("reply"));
}
function RWS(str){
var text2 = str.replace(/\s+$/,"");
return text2.trim();
}
function shortmonth(monthnum) {
var monthname;
shortmonths = ["JAN", "FEB", "MAR","APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"] ;
monthname = shortmonths [monthnum];s
return monthname; }


function TimeNow(Timefld, FocusFld) {

var txt;

var d = new Date(),

thisyear = d.getFullYear();

thismonth= d.getMonth();

thismonth = thismonth+1;

thisday = d.getDate();

h = (d.getHours()<10?'0':'') + d.getHours()

m = (d.getMinutes()<10?'0':'') + d.getMinutes()

s = (d.getSeconds()<10?'0':'') + d.getSeconds();

var myprompt = thisyear+ '-'+thismonth+'-'+thisday+' '+h + ':' + m ;

var RightNow = prompt("", myprompt);

document.getElementById(Timefld).value = RightNow;

document.getElementById(FocusFld).focus();

}

// add save load


function saveTextAsFile(fileNameToSaveAs, textToWrite) {
var textToWrite = document.getElementById('parseme').value; 
var fileNameToSaveAs = "IHS Patient Info " + DateforFile()+".txt";
fileNameToSaveAs = prompt("", fileNameToSaveAs);

  /* Saves a text string as a blob file*/  
  var ie = navigator.userAgent.match(/MSIE\s([\d.]+)/),
      ie11 = navigator.userAgent.match(/Trident\/7.0/) && navigator.userAgent.match(/rv:11/),
      ieEDGE = navigator.userAgent.match(/Edge/g),
      ieVer=(ie ? ie[1] : (ie11 ? 11 : (ieEDGE ? 12 : -1)));

  if (ie && ieVer<10) {
    console.log("No blobs on IE ver<10");
    return;
  }

  var textFileAsBlob = new Blob([textToWrite], {
    type: 'text/plain'
  });

  if (ieVer>-1) {
    window.navigator.msSaveBlob(textFileAsBlob, fileNameToSaveAs);

  } else {
    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
    downloadLink.onclick = function(e) { document.body.removeChild(e.target); };
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink);
    downloadLink.click();
  }
}





function destroyClickedElement(event)
{
    document.body.removeChild(event.target);
}

function loadFileAsText()
{

    var fileToLoad = document.getElementById("fileToLoad").files[0];
 
    var fileReader = new FileReader();
    fileReader.onload = function(fileLoadedEvent) 
    {
        var textFromFileLoaded = fileLoadedEvent.target.result;
        document.getElementById("inputTextToSave").value = textFromFileLoaded;
    };
    fileReader.readAsText(fileToLoad, "UTF-8");
}


function DateforFile(RightNow) {
var txt;
var d = new Date(),
thisyear = d.getFullYear();
thismonth= d.getMonth();
thismonth = thismonth+1;
if (thismonth < 10) { thismonth = "0" + thismonth}

thisday = d.getDate();
if (thisday < 10) { thisday = "0" + thisday}

h = (d.getHours()<10?'0':'') + d.getHours()
m = (d.getMinutes()<10?'0':'') + d.getMinutes()
var myprompt = thisyear+ '-'+thismonth+'-'+thisday+' '+h + '_' + m ;
return myprompt;
}

function isObject(arg) {
  return Object.prototype.toString.call(arg)==='[object Object]';
}

function formDataToObject(elForm) {
  if (!elForm instanceof Element) return;
  var fields = elForm.querySelectorAll('input, select, textarea'),
    o = {};
  for (var i=0, imax=fields.length; i<imax; ++i) {
    var field = fields[i],
      sKey = field.name || field.id;
    if (field.type==='button' || field.type==='image' || field.type==='submit' || !sKey) continue;
    switch (field.type) {
      case 'checkbox':
        o[sKey] = +field.checked;
        break;
      case 'radio':
        if (o[sKey]===undefined) o[sKey] = '';
        if (field.checked) o[sKey] = field.value;
        break;
      case 'select-multiple':
        var a = [];
        for (var j=0, jmax=field.options.length; j<jmax; ++j) {
          if (field.options[j].selected) a.push(field.options[j].value);
        }
        o[sKey] = a;
        break;
      default:
        o[sKey] = field.value;
    }
  }
 // alert('Form data:\n\n' + JSON.stringify(o, null, 2));
 document.getElementById('parseme').value = JSON.stringify(o, null, 2);
//  return o;
}

function populateForm(o) {

o =  JSON.parse(document.getElementById('parseme').value);
 //if (!isObject(o)) return;
if (!isObject(o)) return;
  for (var i in o) {
    var el = document.getElementById(i) || document.querySelector('[name=' + i + ']');
    if (el.type==='radio') el = document.querySelectorAll('[name=' + i + ']');
    switch (typeof o[i]) {
      case 'number':
        el.checked = o[i];
        break;
      case 'object':
        if (el.options && o[i] instanceof Array) {
          for (var j=0, jmax=el.options.length; j<jmax; ++j) {
            if (o[i].indexOf(el.options[j].value)>-1) el.options[j].selected = true;
          }
        }
        break;
      default:
        if (el instanceof NodeList) {
          for (var j=0, jmax=el.length; j<jmax; ++j) {
            if (el[j].value===o[i]) el[j].checked = true;
          }
        } else {
          el.value = o[i];
        }
    }
  }
    Fixfields();


}

function SaveData() {
	
			formDataToObject(document.getElementById('myform'))
			saveTextAsFile();
			
			//saveTextAsFile();
			}

//-------
 function readBlob(opt_startByte, opt_stopByte) {
  
    var files = document.getElementById('files').files;
    if (!files.length) {
      alert('Please select a file!');
      return;
    }

    var file = files[0];
    var start = parseInt(opt_startByte) || 0;
    var stop = parseInt(opt_stopByte) || file.size - 1;

    var reader = new FileReader();

    // If we use onloadend, we need to check the readyState.
    reader.onloadend = function(evt) {
      if (evt.target.readyState == FileReader.DONE) { // DONE == 2
        document.getElementById('byte_content').textContent = evt.target.result;
        document.getElementById('byte_range').textContent = 
            ['Read bytes: ', start + 1, ' - ', stop + 1,
             ' of ', file.size, ' byte file'].join('');
      }
    };

    var blob = file.slice(start, stop + 1);
    reader.readAsBinaryString(blob);
  }
    	
  window.onload = function () { 
 
 //Check the support for the File API support 
 if (window.File && window.FileReader && window.FileList && window.Blob) {
    var fileSelected = document.getElementById('txtfiletoread');
	
    fileSelected.addEventListener('change', function (e) { 
         //Set the extension for the file 
         var fileExtension = /text.*/; 
         //Get the file object 
         var fileTobeRead = fileSelected.files[0];
        //Check of the extension match 
         if (fileTobeRead.type.match(fileExtension)) { 
             //Initialize the FileReader object to read the 2file 
			
             var fileReader = new FileReader(); 
             fileReader.onload = function (e) { 
                 var fileContents = document.getElementById('filecontents'); 
                
				document.getElementById('parseme').value =fileReader.result;
				populateForm(obj = document.getElementById('parseme').value);
					 } 
             fileReader.readAsText(fileTobeRead); 
         } 
         else { 
             alert("Please select text file"); 
         }
 
    }, false);
} 
 else { 
     alert("Files are not supported"); 
 } 
 Fixfields();
 }
 
 function Fixfields() {
AutoGrowTextArea(document.getElementById("Prob"));
AutoGrowTextArea(document.getElementById("PatCare"));
AutoGrowTextArea(document.getElementById("PatMed"));
AutoGrowTextArea(document.getElementById("CareReq"));
AutoGrowTextArea(document.getElementById("Comments"));
AutoGrowTextArea(document.getElementById("Contact"));
//  AutoGrowTextArea(document.getElementById("Comm3"));
}
// function setcolors() {



</script>
  <body>
<form  style="font-family: Arial;" pbzloc="3" onsubmit="return confirm('To complete your form submission, click OK and close the open browser window. You will return to the new message window so you can post your message to the outbox');" method="post" id="myform" enctype="multipart/form-data" action="http://{FormServer}:{FormPort}">
      </big><table style="width: 1045px; height: 482px;" align="center" border="0"><big>
        </big><tbody><big>
          </big><tr><big>
            </big><td><big>
              </big><table style="font-size: 12px; width: 961px; height: 793px;" border="3" bordercolor="#999999" cellpadding="4" cellspacing="0"><big>
                </big><tbody><big>
                  </big><tr><big>
                    </big>
                  <td style="text-align: center; vertical-align: top; height: 8%; background-color: rgb(204, 255, 255);" colspan="2"><big><span class="style3">&nbsp;<big><big><small><span style="font-weight: bold;"><big><span style="font-style: italic;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;<span class="style4">International Health Service</span></span></big><span class="style4"> -&nbsp; Field Patient Referral &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></span><span class="style4"><small>Vers 6<br />
                      <span style="font-style: italic;">Improving the quality of life among the people of Central America</span></small></span></small></big></big><span class="style4"><big><big><small><small><span style="font-style: italic;"><br />
                      <br />
                        </span></small></small></big></big></span></span></big><span style="font-size: 12px;"><input type="button" value=" Load IHS Patient Form data" onclick="document.getElementById('txtfiletoread').click();" />
  <input type="file" id="txtfiletoread" accept=".txt"  style="display: none;"/>&nbsp;</span></td>
                    <big>
                  </big></tr>
                  <big>
                  </big><tr><big>
                    </big><td colspan="2" style="vertical-align: top; text-align: center;"><div align="left"><span style="font-size: 12px;">
                          <pbzloc style="font-weight: normal;" ="1"><br />
                          <big>
                            <span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>To Email or Radio Call</big>&nbsp; </pbzloc>
                      <input size="60" name="To_Name" maxlength="55" id="To_Name" title="E-mail or Radio call. Seperate multiples with ;" style="color: rgb(204, 0, 0);" />
                      &nbsp;<big style="color: rgb(153, 51, 0);">(Can be
                          changed&nbsp;prior to posting)<br />
                      </big><pbzloc style="font-weight: normal;" ="1">&nbsp;&nbsp;<br />
                      <big>
                          <span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>From Team Name</big>&nbsp;</pbzloc>                        <input size="55" name="Name" maxlength="50" id="Name" title="Your assigned team name" />
                    &nbsp;<big><big>&nbsp;Date/Time&nbsp;</big></big><span style="font-size: 14px;">
                    <input name="time" type="text" id="time" placeholder="Click for Date/Time" onclick="TimeNow('time', 'time')" />
                    </span><big><br />
                </big><br />
                    <big><big><span style="color: rgb(204, 0, 0);"><span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>Patient
                          Name&nbsp;</span>                      <input name="PatName" size="50" maxlength="45" />
&nbsp; Patient Age&nbsp;
<input name="PatAge" size="4" maxlength="3" />
&nbsp;&nbsp; Patient Gender&nbsp;
                      <select name="PatGen" size="3">
                        <option selected="selected">---</option>
                        <option>Male</option>
                        <option>Female</option>
                    </select>
                      &nbsp; <br />
                      <br />
                      <span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>Patient Village&nbsp;                      <input name="Village" size="55" maxlength="50" />
&nbsp;&nbsp;Other&nbsp;
<input name="Other" size="55" maxlength="50" title="This area for added info if desired" />
                      <br />
                    </big></big></span><span class="style4"><big><big></big></big></span><big><big>&nbsp; &nbsp; &nbsp; &nbsp; </big></big></div></td><big>
                  </big></tr><big>
                  </big><tr><big>
                    </big><td colspan="5" style="text-align: center; vertical-align: middle;"><div align="left"><big><big style="color: rgb(204, 0, 0);"><span class="style4"><br />
                              <span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>Patient Complaint / Problem <br />
                              <span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>
                        <textarea name="Prob" id="Prob" rows="2" cols="120" onkeyup="AutoGrowTextArea(this)" onchange="this.value=RWS(this.value)" ></textarea>
                    </span>     <textarea name="parseme" cols="60" id="parseme" style="display: none;"></textarea>  <br />
                      </big></big></div></td><big>
                  </big></tr><big>
                  </big><tr><big>
                    </big><td style="height: 88px; vertical-align: top; text-align: center;" colspan="5"><div align="left"><big><big> <span class="style4">&nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />
                        <span style="color: rgb(0, 153, 0);"><span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>Care
                            Already Given&nbsp; </span><br />
                            <span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>
                        <textarea name="PatCare" id="PatCare" rows="2" cols="120"onkeyup="AutoGrowTextArea(this)" onchange="this.value=RWS(this.value)" ></textarea>
                        <br />
                        <br />
                        <span style="color: rgb(0, 153, 0);"><span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>Meds Already Given
                    </span><br />
                        <span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>
                        <textarea name="PatMed" id="PatMed" rows="2" cols="120"onkeyup="AutoGrowTextArea(this)" onchange="this.value=RWS(this.value)" ></textarea>
                    </span>                        <br />
                        <span class="style4"><br />
                            <span style="color: rgb(0, 153, 0);"><span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>Type of
                            Care Requested </span><br />
                            <span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>
                            <textarea name="CareReq" id="CareReq" rows="2" cols="120"onkeyup="AutoGrowTextArea(this)" onchange="this.value=RWS(this.value)" ></textarea>
                        <br />
                        </span><span class="style4"></span><span class="style4"><br />
                            <span style="color: rgb(0, 153, 0);"><span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>Caregiver
                            Contact</span></span> <span class="style4"><br />
                            </span><big><span class="style1">
                            </span><big><span class="style1"><big><big><big>&nbsp;</big></big></big></span></big><span class="style1">
                            <textarea name="Contact" id="Contact" rows="2" cols="120"onkeyup="AutoGrowTextArea(this)" onchange="this.value=RWS(this.value)" ></textarea>
                            </span></big><span class="style4">                            <br />
                            </span></big></big><span class="style4"><br />
                            </span><span class="style4">
                            </span>
                      </div></td><big>
                  </big></tr><big>
                  </big><tr><big>
                    </big><td colspan="2" style="text-align: center;"><div align="left" class="style4"><big><big><span style="color: rgb(0, 153, 0);"><span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>Additional
                            Information</span><br />
                            <span class="style1"><big><big><big>&nbsp; </big><span class="style4" style="color: rgb(0, 153, 0);"></span></big></big></span>
                            <textarea name="Comments" id="Comments"rows="2" cols="120" onkeyup="AutoGrowTextArea(this)" onchange="this.value=RWS(this.value)" ></textarea>
                        <br />
                      </big>
                    </big></div></td>
                    <big>
                  </big></tr><big>
                  </big><tr><big>
                    </big><td colspan="2" style="height: 35px; text-align: justify; vertical-align: top;">
                        <span class="formtext"><span style="font-family: Calibri;"><small><big><big><small><span style="font-family: Calibri;">
                        <input type="button" value="Save IHS Patient data "  style="color: blue;"onclick="SaveData()" />
                        </span>&nbsp;&nbsp;</small></big></big></small></span></span>
                        <input value="Submit" name="Submit" method="Post" id="Submit" enctype="multipart/form-data" class="SubmitBtn" title="After submitting, close browser, then address message for posting" style="height: 28px; width: 52px; color: green;" type="submit" />&nbsp;<span style="color: rgb(128, 0, 0);"></span><big><input style="color: rgb(204, 0, 0);" name="ResetForm" value="Reset Form " class="BtnFormat2" type="reset" />
&nbsp; &nbsp; <big><small>This form if sent to a normal internet address, will have plain text properly formatted in message body</small>.</big></big><span style="color: rgb(128, 0, 0);"> &nbsp;</span><big>&nbsp; &nbsp; </big><span style="color: rgb(128, 0, 0);"><span style="color: black;"></span><span style="color: black;"></span>
</span><span style="color: rgb(128, 0, 0);"></span></td>
                    <big>
</big></tr><big>
</big></tbody><big>
</big></table>
              <big>
<br />
</big>&nbsp;</td><big>
</big></tr><big>
</big></tbody><big>
</big></table><big>
</big></form>
</body></html>